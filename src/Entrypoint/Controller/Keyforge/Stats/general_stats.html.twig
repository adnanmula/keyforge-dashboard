{% extends "Keyforge/Shared/keyforge_base.html.twig" %}

{% block title %}Keyforge{% endblock %}

{% block body %}
    <div class="shadow-lg p-3 mb-5 bg-white rounded">
        <div class="row">
            <a href="{{ path('keyforge_decks') }}" class="btn btn-dark border col-12 col-sm-6 col-lg-3">
                <h5>Barajas registradas</h5>
                <p></p>
                <p>{{ data.deck_count }}</p>
            </a>

            <a class="btn btn-dark border col-12 col-sm-6 col-lg-3">
                <h5>Partidas jugadas</h5>
                <p></p>
                <p>{{ data.games_played }}</p>
            </a>

            <a href="{{ path('keyforge_competition_list') }}" class="btn btn-dark border col-12 col-sm-6 col-lg-3">
                <h5>Torneos</h5>
                <p></p>
                <p>{{ data.competition_count }}</p>
            </a>

            <a href="{{ path('keyforge_user_list') }}" class="btn btn-dark border col-12 col-sm-6 col-lg-3">
                <h5>Jugadores</h5>
                <p></p>
                <p>{{ data.player_count }}</p>
            </a>
        </div>

        <div class="row mt-3">
            <div class="col-12 col-sm-6 col-lg-3">
                <canvas id="setWins" width="400" height="400"></canvas>
            </div>
            <div class="col-12 col-sm-6 col-lg-3">
                <canvas id="setWinRate" width="400" height="400"></canvas>
            </div>
            <div class="col-12 col-sm-6 col-lg-3">
                <canvas id="setPickRate" width="400" height="400"></canvas>
            </div>
            <div class="col-12 col-sm-6 col-lg-3">
                <canvas id="setPresence" width="400" height="400"></canvas>
            </div>
        </div>

        <div class="row mt-3">
            <div class="col-12 col-sm-6 col-lg-3">
                <canvas id="houseWins" width="400" height="450"></canvas>
            </div>
            <div class="col-12 col-sm-6 col-lg-3">
                <canvas id="houseWinRate" width="400" height="450"></canvas>
            </div>
            <div class="col-12 col-sm-6 col-lg-3">
                <canvas id="housePickRate" width="400" height="450"></canvas>
            </div>
            <div class="col-12 col-sm-6 col-lg-3">
                <canvas id="housePresence" width="400" height="400"></canvas>
            </div>
        </div>
    </div>

    <script>
        let setPresence = JSON.parse('{{ data.set_presence|json_encode|raw }}');
        let housePresence = JSON.parse('{{ data.house_presence|json_encode|raw }}');
        let setWins = JSON.parse('{{ data.set_wins|json_encode|raw }}');
        let houseWins = JSON.parse('{{ data.house_wins|json_encode|raw }}');
        let setWinRate = JSON.parse('{{ data.set_win_rate|json_encode|raw }}');
        let houseWinRate = JSON.parse('{{ data.house_win_rate|json_encode|raw }}');
        let setPickRate = JSON.parse('{{ data.set_pick_rate|json_encode|raw }}');
        let housePickRate = JSON.parse('{{ data.house_pick_rate|json_encode|raw }}');

        const setPresenceChart = new Chart(document.getElementById('setPresence').getContext('2d'), {
            type: 'doughnut',
            data: {
                datasets: [{
                    data: Object.values(setPresence),
                    backgroundColor: [
                        'rgb(255, 99, 132)',
                        'rgb(54, 162, 235)',
                        'rgb(210, 145, 188)',
                        'rgb(179, 217, 178)',
                        'rgb(114, 99, 143)',
                        'rgb(177, 29, 33)',
                    ],
                }],
                labels: Object.keys(setPresence),
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: false,
                        position: 'bottom',
                    },
                    title: {
                        display: true,
                        text: 'Sets'
                    }
                }
            },
        });

        const housePresenceChart = new Chart(document.getElementById('housePresence').getContext('2d'), {
            type: 'doughnut',
            data: {
                datasets: [{
                    data: Object.values(housePresence),
                    backgroundColor: [
                        'rgb(41, 128, 185)', //Sanctum
                        'rgb(225, 78, 183)', //Dis
                        'rgb(46, 204, 113)', //Mars
                        'rgb(125, 60, 152)', //Star Alliance
                        'rgb(22, 160, 133)', //Saurian
                        'rgb(81, 90, 90)',   //Shadows
                        'rgb(20, 90, 50)',   //Untamed
                        'rgb(231, 76, 60)',  //Brobnar
                        'rgb(21, 67, 96)',   //Unfathomable
                        'rgb(52, 152, 219)', //Logos
                        'rgb(177, 29, 33)',  //Ekwidon
                    ],
                }],
                labels: Object.keys(housePresence),
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: false,
                        position: 'bottom',
                    },
                    title: {
                        display: true,
                        text: 'Casas'
                    }
                }
            },
        });

        const setWinsChart = new Chart(document.getElementById('setWins').getContext('2d'), {
            type: 'bar',
            data: {
                labels: Object.keys(setWins),
                datasets: [
                    {
                        label: 'Wins',
                        data: Object.values(setWins),
                        borderColor: 'rgb(37, 41, 33)',
                        backgroundColor: 'rgb(37, 41, 33)',
                    },
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: false,
                        position: 'bottom',
                    },
                    title: {
                        display: true,
                        text: 'Victorias por set'
                    }
                }
            },
        });

        const houseWinsChart = new Chart(document.getElementById('houseWins').getContext('2d'), {
            type: 'bar',
            data: {
                labels: Object.keys(houseWins),
                datasets: [
                    {
                        label: 'Wins',
                        data: Object.values(houseWins),
                        borderColor: 'rgb(37, 41, 33)',
                        backgroundColor: 'rgb(37, 41, 33)',
                    },
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: false,
                        position: 'bottom',
                    },
                    title: {
                        display: true,
                        text: 'Victorias por casa'
                    }
                }
            },
        });

        const setWinRateChart = new Chart(document.getElementById('setWinRate').getContext('2d'), {
            type: 'bar',
            data: {
                labels: Object.keys(setWinRate),
                datasets: [
                    {
                        label: '%',
                        data: Object.values(setWinRate),
                        borderColor: 'rgb(37, 41, 33)',
                        backgroundColor: 'rgb(37, 41, 33)',
                    },
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: false,
                        position: 'bottom',
                    },
                    title: {
                        display: true,
                        text: 'Win rate por set'
                    }
                }
            },
        });

        const houseWinRateChart = new Chart(document.getElementById('houseWinRate').getContext('2d'), {
            type: 'bar',
            data: {
                labels: Object.keys(houseWinRate),
                datasets: [
                    {
                        label: '%',
                        data: Object.values(houseWinRate),
                        borderColor: 'rgb(37, 41, 33)',
                        backgroundColor: 'rgb(37, 41, 33)',
                    },
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: false,
                        position: 'bottom',
                    },
                    title: {
                        display: true,
                        text: 'Win rate por casa'
                    }
                }
            },
        });

        const setPickRateChart = new Chart(document.getElementById('setPickRate').getContext('2d'), {
            type: 'bar',
            data: {
                labels: Object.keys(setPickRate),
                datasets: [
                    {
                        label: '%',
                        data: Object.values(setPickRate),
                        borderColor: 'rgb(37, 41, 33)',
                        backgroundColor: 'rgb(37, 41, 33)',
                    },
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: false,
                        position: 'bottom',
                    },
                    title: {
                        display: true,
                        text: 'Pick rate por set'
                    }
                }
            },
        });

        const housePickRateChart = new Chart(document.getElementById('housePickRate').getContext('2d'), {
            type: 'bar',
            data: {
                labels: Object.keys(housePickRate),
                datasets: [
                    {
                        label: '%',
                        data: Object.values(housePickRate),
                        borderColor: 'rgb(37, 41, 33)',
                        backgroundColor: 'rgb(37, 41, 33)',
                    },
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        display: false,
                        position: 'bottom',
                    },
                    title: {
                        display: true,
                        text: 'Pick rate por casa'
                    }
                }
            },
        });
    </script>
{% endblock %}
